<!DOCTYPE html>
<html>

    <head>
        <meta charset="UTF-8">
        <title>testCanvas</title>
        <script src="../js/ol.js"></script>
        <script src="../js/jquery-1.11.1.min.js"></script>
        <link rel="stylesheet" type="text/css" href="../css/ol.css" />
    </head>

    <body>
        <div id="map" style="width: 100%; height:100%;">
            <!--<canvas id="myCanvas" width="200" height="100" style="border:1px solid #000000;"></canvas>-->
        </div>
        <script>
//          var isFirst=true;//是否第一次加载该canvas图层
//          var canvasOption=new Object();
            //ImageCanvas有一个canvasFunction属性
            //通过查看源代码，发现该属性其实是一个回调函数，需要对该函数进行实现，从而创建一个canvas
            //创建回调函数如下
//          canvasOption.canvasFunction = function(extent, resolution, pixelRatio, size, projection) {
//              if(isFirst) //这里必须要做一个判断，每次的范围变动都会引起重绘，从而触发该回调函数，不判断的话，将会导致canvas无法被绘制到地图上，出现闪现的情况
//              {
//                  isFirst = false;
//                  var canvas = document.createElement('canvas');
//                  canvas.width = size[0];
//                  canvas.height = size[1];
//                  var context = canvas.getContext('2d');
//                  context.fillStyle = "blue";
//                  context.fillRect(0, 0, 100, 100);
//                  return canvas;
//              }
//          };
            //为ImageCanvasLayer创建数据源
//          var imageCanvas = new ol.source.ImageCanvas(canvasOption);
            //创建一个ImageCanvasLayer图层
//          var imageCanvasLayer = new ol.layer.Image({
//              source: imageCanvas
//          });
            
            let vLayer = new ol.layer.Vector({
                source: new ol.source.Vector({})
            });
            let map = new ol.Map({
                target: 'map',
                layers: [
//                  new ol.layer.Tile({source: new ol.source.OSM()}),
//                  imageCanvasLayer,
                    vLayer
                ],
                view: new ol.View({
                    projection: ol.proj.get('EPSG:4326'),
                    center: [112, 40],
                    zoom: 4
                })
            });
            
            let lineCd = [[110, 40], [115, 40]];
            let style = new ol.style.Style({
//              geometry: new ol.geom.LineString(lineCd),
                renderer: function (coor, state) {
                    console.log(coor);
                    state.context.beginPath(); //必须加，否则会出现一些不明边框
                    state.context.moveTo(coor[0][0],coor[0][1]);
                    state.context.lineTo(coor[1][0],coor[1][1]);
                    state.context.stroke();
                }
            })
            let line = new ol.Feature(new ol.geom.LineString(lineCd));
            line.setStyle(style);
            vLayer.getSource().addFeature(line);
            
            console.log(map.getView().getResolutions());
            console.log(Math.sin(Math.PI / 2), Math.atan(111111111111111))
            
        </script>
    </body>

</html>