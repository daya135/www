<!DOCTYPE html>
<html>

    <head>
        <meta charset="UTF-8">
        <title>testLine</title>
        <script src="../js/ol.js"></script>
        <script src="../js/jquery-1.11.1.min.js"></script>
        <link rel="stylesheet" type="text/css" href="../css/ol.css" />
    </head>

    <body>
        <div id="map" style="width: 100%; height: 100%;"></div>
        <script>
            let bounds = [80, 20, 150, 60];
            let center = [115.1319834154143, 26.000386873762483];
            //          let projection = new ol.proj.Projection({
            //              code: 'EPSG:4326',
            //              units: 'DEGREES',
            //              extent: bounds
            //          });
            let projection = ol.proj.get('EPSG:4326');

            let source = new ol.source.Vector({
            
            });

            let vLayer = new ol.layer.Vector({
                source: source
            });
            let rLayer = new ol.layer.Tile({
                source: new ol.source.OSM()
            });
            let view = new ol.View({
                projection: projection,
                center: center,
//              zoom: 6
                zoom: 11
            });

            let map = new ol.Map({
                target: 'map',
                view: view,
                layers: [rLayer,vLayer],
//              layers: [vLayer]
            });

            let lineCoordinate = [
                [150, 30],
                [160, 30]
            ];
//          let lineCoordinate2 = [
//              [150, 31],
//              [160, 31]
//          ];
            let lineCoordinate2 = [
        [
          115.13333333332476,
          25.98070775005159
        ],
        [
          115.13124847412109,
          25.972337722776928
        ],
        [
          115.13010406494139,
          25.968278884886306
        ],
        [
          115.12767028808592,
          25.963836669920472
        ],
        [
          115.12663269042967,
          25.962471008299346
        ],
        [
          115.12507629394531,
          25.960886001585507
        ],
        [
          115.12300872802733,
          25.958734512327695
        ],
        [
          115.12030792236328,
          25.956989288328639
        ],
        [
          115.11728668212889,
          25.9554786682115
        ],
        [
          115.11485290527342,
          25.954364776609903
        ],
        [
          115.11042785644531,
          25.952299118040578
        ],
        [
          115.10298919677733,
          25.949184417723224
        ],
        [
          115.0836266191308,
          25.936077805451649
        ],
        [
          115.07559578184105,
          25.930640119586663
        ],
        [
          115.05891418457031,
          25.919342041014211
        ],
        [
          115.05359649658202,
          25.9167137145982
        ],
        [
          115.04454803466796,
          25.911836624144104
        ],
        [
          115.03838348388672,
          25.908184051512258
        ],
        [
          115.03471981746377,
          25.90455298278858
        ],
        [
          115.03004966984167,
          25.898228392632518
        ],
        [
          115.02806091308594,
          25.895118713377521
        ],
        [
          115.02399444580078,
          25.887193679808124
        ],
        [
          115.02054595947264,
          25.882534027098231
        ],
        [
          115.00514221191406,
          25.873315811155845
        ],
        [
          114.98802947998047,
          25.86480522155621
        ],
        [
          114.97985076904297,
          25.854177474974204
        ],
        [
          114.97528839111328,
          25.846544265745674
        ],
        [
          114.96027374267578,
          25.825155258177322
        ],
        [
          114.95970916748047,
          25.821146011351125
        ],
        [
          114.95787811279296,
          25.813421249388202
        ],
        [
          114.95377349853516,
          25.807044982908742
        ],
        [
          114.95075225830078,
          25.804500579832574
        ],
        [
          114.94370269775391,
          25.800626754759314
        ],
        [
          114.92349243164063,
          25.788246154783721
        ],
        [
          114.91282653808594,
          25.78051185607767
        ],
        [
          114.87712860107422,
          25.746278762816
        ],
        [
          114.87274932861328,
          25.741970062254435
        ],
        [
          114.86845397949219,
          25.739149093626498
        ],
        [
          114.85813140869139,
          25.7329578399644
        ],
        [
          114.81486511230467,
          25.714229583738806
        ],
        [
          114.81010280692846,
          25.710249540514788
        ],
        [
          114.80504167277817,
          25.704726923057368
        ],
        [
          114.78681945800781,
          25.678974151609918
        ],
        [
          114.78462219238281,
          25.671482086180191
        ],
        [
          114.78353881835938,
          25.666215896605014
        ],
        [
          114.77994001393977,
          25.647638769053263
        ],
        [
          114.77330505648224,
          25.63598209082128
        ],
        [
          114.76958223192774,
          25.630560139466027
        ],
        [
          114.76823143981592,
          25.628623846805436
        ],
        [
          114.76554159485511,
          25.622291268109237
        ],
        [
          114.76435898711628,
          25.617339834389302
        ],
        [
          114.76288003761583,
          25.611287892593527
        ],
        [
          114.76230201938157,
          25.606614161305011
        ],
        [
          114.76233169742619,
          25.60166866181676
        ],
        [
          114.7623809114681,
          25.601395983972985
        ],
        [
          114.76345828823949,
          25.595426301876646
        ],
        [
          114.7635955810547,
          25.594665527342329
        ],
        [
          114.76546184518568,
          25.586843632234974
        ],
        [
          114.76676570604812,
          25.581076920435105
        ],
        [
          114.76743316650391,
          25.578100204466359
        ],
        [
          114.76745249209525,
          25.575389801659728
        ]
      ];
            let lineCd3 = [
                [150, 29],
                [160.99, 29]
            ];
            let lineCd3_1 = [
                [161, 29],[162, 29],[163, 30],[163.5, 31], [165, 29]
            ];
            let lineCd4 = [
                [150, 32],
                [160, 32],
                [165, 34]
            ];
            let peak = [160.995, 29];

            let colors = ['#FF6EB4', '#FF4500', '#DAA520', '#C0FF3E', '#B0E2FF', '#8B1A1A', '#454545', '#FFB90F']
            let lineStyle = new ol.style.Style({
                stroke: new ol.style.Stroke({
                    color: '#FF6EB4',
                    width: 3,
                    lineDash: [14, 6, 2, 6]
                })
            });
            let lineStyle2 = new ol.style.Style({
                stroke: new ol.style.Stroke({
                    color: '#000000',
                    width: 3,
                    lineCap: 'butt',
                    lineDash: [10, 10]
                })
            });
            let lineStyle2_1 = new ol.style.Style({
                stroke: new ol.style.Stroke({
                    color: '#FFFFFF',
                    width: 3,
                    lineCap: 'butt',
                    lineDash: [0, 10, 10, 0] //生成与黑线相反填充顺序的虚线
                })
            });
            let lineStyle3 = new ol.style.Style({
                stroke: new ol.style.Stroke({
                    color: '#000000FF',
                    lineCap: 'butt',
                    width: 3,
                })
            });
            let lineStyle3_1 = new ol.style.Style({
                stroke: new ol.style.Stroke({
                    color: '#000000',
                    width: 10,
                    lineCap: 'butt',
                    lineDash: [1, 3, 1, 40]
                })
            });
            let lineStyle4_1 = new ol.style.Style({
                stroke: new ol.style.Stroke({
                    color: '#000000',
                    width: 3,
                    lineCap: 'butt',
                    lineDash: [16, 7, 2, 7]
                })
            });
            let lineStyle4_2 = new ol.style.Style({
                stroke: new ol.style.Stroke({
                    color: '#000000',
                    width: 6,
                    lineCap: 'butt',
                    lineDash: [1, 15, 1, 15]
                })
            });
            let pointStyle = function() {
                let FtScale = map === null ? 0.5 : map.getView().getZoom() * 0.05;
                let CurDist = ol.sphere.getDistance([115.99, 32], [116, 32]);
                let resolution = view.getResolution();
                let ins = CurDist / projection.getMetersPerUnit() / resolution

                console.log('distance', CurDist, resolution, projection.getMetersPerUnit(), ins);

                let coorlen = CurDist / projection.getMetersPerUnit();

                return new ol.style.Style({
                    image: new ol.style.Icon({
                        src: '../img/icon/peak.png',
                        size: [200, 200],
                        scale: 0.1 + ((view.getZoom() - 11.4) > 0 ? (view.getZoom() - 11.4) : 0) * 0.1
//                      scale:3
                    })
                });
            }

            map.getView().on('change:resolution', function() {

                let x = 1280 + ((115.995 - 110) / view.getResolution() + 0.5);
                let y = 800 - ((29 - 25) / view.getResolution() + 0.5);
                console.log('resolution, zoom ', view.getResolution(), view.getZoom(), x, y);
            });

            let line = new ol.Feature(new ol.geom.LineString(lineCoordinate));
            let line2 = new ol.Feature(new ol.geom.LineString(lineCoordinate2));
            let line2_1 = new ol.Feature(new ol.geom.LineString(lineCoordinate2));
            let line3 = new ol.Feature(new ol.geom.LineString(lineCd3));
            let line3_1 = new ol.Feature(new ol.geom.LineString(lineCd3));
            let line3_2 = new ol.Feature(new ol.geom.LineString(lineCd3_1));
            let line3_3 = new ol.Feature(new ol.geom.LineString(lineCd3_1));
            let line4_1 = new ol.Feature(new ol.geom.LineString(lineCd4));
            let line4_2 = new ol.Feature(new ol.geom.LineString(lineCd4));
            let point = new ol.Feature(new ol.geom.Point(peak));

            line.setStyle(lineStyle);
            line2.setStyle(lineStyle2);
            line2_1.setStyle(lineStyle2_1);
            line3.setStyle(lineStyle3);
            line3_1.setStyle(lineStyle3_1);
            line3_2.setStyle(lineStyle3);
            line3_3.setStyle(lineStyle3_1);
            line4_1.setStyle(lineStyle4_1);
            line4_2.setStyle(lineStyle4_2);
            point.setStyle(pointStyle);
            source.addFeature(line);
            source.addFeature(line2_1);
            source.addFeature(line2);
            source.addFeature(line3);
            source.addFeature(line3_1);
            source.addFeature(line3_2);
            source.addFeature(line3_3);
            source.addFeature(line4_1);
            source.addFeature(line4_2);
            source.addFeature(point);
        </script>
    </body>

</html>